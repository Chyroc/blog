<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=zh-cn lang=zh-cn><head><link href=https://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=generator content="Hugo 0.68.3"><meta name=viewport content="width=device-width,initial-scale=1"><title>在 github 开启 gpg 的几个 Q&A &#183; Chyroc的博客</title><meta name=description content><link type=text/css rel=stylesheet href=https://chyroc.cn/css/print.css media=print><link type=text/css rel=stylesheet href=https://chyroc.cn/css/poole.css><link type=text/css rel=stylesheet href=https://chyroc.cn/css/syntax.css><link type=text/css rel=stylesheet href=https://chyroc.cn/css/hyde.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700"><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/favicon.png></head><body class=theme-base-08><aside class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><a href=https://chyroc.cn><h1>Chyroc的博客</h1></a><p class=lead></p></div><nav><ul class=sidebar-nav><li><a href=https://chyroc.cn>Home</a></li><li><a href=/>主页</a></li><li><a href=/blogroll/>友链</a></li><li><a href=/about/>关于</a></li></ul></nav></div></aside><main class="content container"><div class=post><h1>在 github 开启 gpg 的几个 Q&A</h1><time datetime=2018-07-25T16:17:51+0800 class=post-date>2018-07-25 16:17:51</time><p><strong>本文不是解释 gpg 和解释 github 如何开启 gpg 的文章，仅仅记录一下我在 github 开启 gpg 的几个 Q&A</strong></p><h2 id=如何查看备份与删除秘钥>如何查看、备份与删除秘钥</h2><h3 id=查看>查看</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>➜  gpg --list-keys
/Users/chyroc/.gnupg/pubring.kbx
--------------------------------
pub   rsa2048 2018-07-25 <span style=color:#f92672>[</span>SC<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>有效至：2020-07-24<span style=color:#f92672>]</span>
      &lt;gpg id&gt;
uid           <span style=color:#f92672>[</span> 绝对 <span style=color:#f92672>]</span> Chyroc &lt;xxxx@xxxx.com&gt;
sub   rsa2048 2018-07-25 <span style=color:#f92672>[</span>E<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>有效至：2020-07-24<span style=color:#f92672>]</span>
</code></pre></div><h3 id=备份>备份</h3><p>github 现在不支持<code>@foxmail.com</code>邮箱，导致 github 不再支持我以前生成的 gpg 秘钥，所以我需要重新生成一个秘钥。</p><p>但是现在这个秘钥我已经在 pypi 中使用了，所以我需要先备份秘钥，然后再删除。</p><p>执行下面这个命令将秘钥导出到文件</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>gpg -o pri_key.gpg --export-secret-keys &lt;gpg id&gt;
gpg -o pub_key.gpg --export &lt;gpg id&gt;
</code></pre></div><h3 id=删除>删除</h3><p>再执行下面两个命令删除</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>gpg --delete-secret-keys &lt;gpg id&gt;
gpg --delete-keys &lt;gpg id&gt;
</code></pre></div><h2 id=如何在-github-开启-gpg>如何在 github 开启 gpg</h2><h3 id=生成公钥>生成公钥</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>gpg --armor --export &lt;gpg id&gt;
</code></pre></div><h3 id=然后将生成的公钥上传到-httpsgithubcomsettingskeys>然后将生成的公钥上传到 <a href=https://github.com/settings/keys>https://github.com/settings/keys</a></h3><h2 id=git-开启-gpg>git 开启 gpg</h2><p>执行下面三个命令</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>git config --global user.signingkey &lt;gpg id&gt;
git config --global gpg.program <span style=color:#66d9ef>$(</span>which gpg<span style=color:#66d9ef>)</span>
git config --global commit.gpgsign true
</code></pre></div><h2 id=解决-gpg-failed-to-sign-the-data>解决 gpg failed to sign the data</h2><p>如果 commit 的时候报错：<code>gpg failed to sign the data</code></p><p>先执行</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>brew upgrade gnupg  <span style=color:#75715e># This has a make step which takes a while</span>
brew link --overwrite gnupg
brew install pinentry-mac
echo <span style=color:#e6db74>&#34;pinentry-program /usr/local/bin/pinentry-mac&#34;</span> &gt;&gt; ~/.gnupg/gpg-agent.conf
killall gpg-agent
</code></pre></div><p>然后再 commit</p><p>成功！</p><p><img src=https://media.chyroc.cn/img/blog/github-commit-with-gpg.1.jpg alt></p><h2 id=参考>参考</h2><ul><li><a href=https://github.com/muwenzi/Program-Blog/issues/133>https://github.com/muwenzi/Program-Blog/issues/133</a></li><li><a href=http://www.ruanyifeng.com/blog/2013/07/gpg.html>http://www.ruanyifeng.com/blog/2013/07/gpg.html</a></li></ul></div><script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script src=../../js/jquery-3.3.1.min.js></script><script src=../../js/code.js></script><script src=../../css/highlight.css></script><script src=../../js/instantclick.min.js data-no-instant></script><script data-no-instant>InstantClick.init();</script><script>hljs.configure({languages:[]});hljs.initHighlightingOnLoad();</script><hr>© <a href=https://chyroc.cn>chyroc</a> <a href=https://github.com/spf13/hyde>Theme By hyde</a> 2020
<span id=reading-statistics><span><div id=git-comments></div><link rel=stylesheet href=https://imsun.github.io/gitment/style/default.css><script src=https://imsun.github.io/gitment/dist/gitment.browser.js></script><script>var gitment=new Gitment({id:'github-commit-with-gpg',title:'在 github 开启 gpg 的几个 Q\x26A',owner:'chyroc',repo:'blog',oauth:{client_id:'36628d87f0ace3c0f34c',client_secret:'814e29f878a31ddf2a0f8f010c2bc3615750a998',}})
gitment.render('git-comments')</script></main></body></html>