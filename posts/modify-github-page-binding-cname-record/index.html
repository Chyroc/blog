<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=zh-cn lang=zh-cn><head><link href=https://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=generator content="Hugo 0.68.3"><meta name=viewport content="width=device-width,initial-scale=1"><title>修改 github page 绑定的 cname 记录 &#183; Chyroc的博客</title><meta name=description content><link type=text/css rel=stylesheet href=https://chyroc.cn/css/print.css media=print><link type=text/css rel=stylesheet href=https://chyroc.cn/css/poole.css><link type=text/css rel=stylesheet href=https://chyroc.cn/css/syntax.css><link type=text/css rel=stylesheet href=https://chyroc.cn/css/hyde.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700"><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/favicon.png></head><body class=theme-base-08><aside class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><a href=https://chyroc.cn><h1>Chyroc的博客</h1></a><p class=lead></p></div><nav><ul class=sidebar-nav><li><a href=https://chyroc.cn>Home</a></li><li><a href=/>主页</a></li><li><a href=/blogroll/>友链</a></li><li><a href=/about/>关于</a></li></ul></nav></div></aside><main class="content container"><div class=post><h1>修改 github page 绑定的 cname 记录</h1><time datetime=2018-06-26T19:02:37+0800 class=post-date>2018-06-26 19:02:37</time><p>原来我的 github page 绑定的域名是 blog.chyroc.cn，然后我那个<a href=https://github.com/Chyroc/chyroc.github.io>repo</a>是我的博客项目，这个本来是没有什么问题的。</p><p>但是如果你其他的项目也开启了 github page 服务，比如项目https://github.com/Chyroc/golang-wasm-example ，这个项目开启 github page 后，访问的地址是 <a href=https://blog.chyroc.cn/golang-wasm-example>https://blog.chyroc.cn/golang-wasm-example</a> ，一个和 blog 没啥关系的项目的访问链接里面带了 blog，这样就比较奇怪。</p><p>所以我准备将我的 github page 绑定的域名从 blog.chyroc.cn 改为 chyroc.cn。</p><h2 id=第一步修改-github-repo-的-cname-记录>第一步，修改 github repo 的 CNAME 记录</h2><p>commit：https://github.com/Chyroc/chyroc.github.io/commit/b253413fa3d64b4f9408ebe1100fcf79faa9d883</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=color:#f92672>-blog.chyroc.cn
</span><span style=color:#f92672></span><span style=color:#a6e22e>+chyroc.cn
</span></code></pre></div><h2 id=第二步修改域名解析记录>第二步，修改域名解析记录</h2><ul><li>移除原来的主机类型为<code>@</code>的 A 记录</li><li>移除原来指向 chyroc.github.io 的主机类型为<code>blog</code>的 CNAME 记录</li><li>添加主机类型为<code>@</code>的指向 github page ip 的 A 记录（可选 ip 在<a href=https://help.github.com/articles/setting-up-an-apex-domain/>这里</a>有记录：我用的是 185.199.108.153）</li></ul><p><img src=https://media.chyroc.cn/img/blog/modify-github-page-binding-cname-record-dns-setting-2.jpg alt>
<img src=https://media.chyroc.cn/img/blog/modify-github-page-binding-cname-record-dns-setting.jpeg alt></p><h2 id=第三步修改服务器-nginx-配置>第三步，修改服务器 nginx 配置</h2><ul><li>移除 chyroc.cn 的 nginx 配置</li></ul><p>原来的 chyroc.cn 是指向我的云主机的，由服务器上面的 nginx 做反向代理，现在需要删除该配置，即移除 <code>server_name chyroc.cn</code>这一项</p><ul><li>添加 blog.chyroc.cn 的重定向</li></ul><p>为了保证原来的 blog 链接还能正常工作，也就是 <a href=https://blog.chyroc.cn/posts/some-experience-with-writing-dockerfile/>https://blog.chyroc.cn/posts/some-experience-with-writing-dockerfile/</a> 还能正常访问，需要设置 blog.chyroc.cn/xxx 重定向到 chyroc.cn/xxx</p><p>我们使用 nginx 做这件事情，添加 nginx 配置：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=color:#66d9ef>server</span> {
    <span style=color:#f92672>server_name</span>  <span style=color:#e6db74>blog.chyroc.cn</span>;
    <span style=color:#f92672>return</span> <span style=color:#ae81ff>301</span> <span style=color:#e6db74>https://chyroc.cn/</span>$request_uri;
}
</code></pre></div><h1 id=第四步修改各个地方硬编码的-blogchyroccn>第四步，修改各个地方硬编码的 blog.chyroc.cn</h1><p>例如：</p><ul><li>本博客中链接</li><li>各个介绍</li><li>等等</li></ul></div><script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script src=../../js/jquery-3.3.1.min.js></script><script src=../../js/code.js></script><script src=../../css/highlight.css></script><script src=../../js/instantclick.min.js data-no-instant></script><script data-no-instant>InstantClick.init();</script><script>hljs.configure({languages:[]});hljs.initHighlightingOnLoad();</script><hr>© <a href=https://chyroc.cn>chyroc</a> <a href=https://github.com/spf13/hyde>Theme By hyde</a> 2020
<span id=reading-statistics><span><div id=git-comments></div><link rel=stylesheet href=https://imsun.github.io/gitment/style/default.css><script src=https://imsun.github.io/gitment/dist/gitment.browser.js></script><script>var gitment=new Gitment({id:'modify-github-page-binding-cname-record',title:'修改 github page 绑定的 cname 记录',owner:'chyroc',repo:'blog',oauth:{client_id:'36628d87f0ace3c0f34c',client_secret:'814e29f878a31ddf2a0f8f010c2bc3615750a998',}})
gitment.render('git-comments')</script></main></body></html>